[pytest]
# Test discovery patterns
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Directories to search for tests
testpaths = tests

# Minimum Python version
minversion = 7.4

# Async test support
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function

# Test execution options
# Note: Coverage options removed from default to avoid architecture issues
# Use: pytest --cov=mcp_agent to run with coverage
addopts =
    --strict-markers
    --strict-config
    -ra
    --verbose

# Custom markers for test categorization
markers =
    unit: Unit tests for individual components
    integration: Integration tests for workflows and multi-component interactions
    e2e: End-to-end test scenarios
    slow: Tests that take longer to execute
    requires_api: Tests that require mcpproxy API to be running
    requires_llm: Tests that require LLM API access
    diagnostic: Tests for diagnostic tools
    config: Tests for configuration management
    discovery: Tests for server discovery
    testing: Tests for testing tools
    logs: Tests for log analysis
    docs: Tests for documentation tools
    startup: Tests for startup script management
    graph: Tests for LangGraph state machine

# Logging configuration
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Timeout for tests (prevent hanging - requires pytest-timeout)
# Uncomment if pytest-timeout is installed:
# timeout = 300
# timeout_method = thread

# Warnings configuration
filterwarnings =
    error
    ignore::UserWarning
    ignore::DeprecationWarning

# Test output configuration
console_output_style = progress

# Parallel execution (when using pytest-xdist)
# addopts = -n auto

# Cache configuration
cache_dir = .pytest_cache
